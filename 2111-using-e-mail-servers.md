# 211.1. استفاده از سرورهای ایمیل

## **211.1 Using e-mail servers**

**وزن:** 4

**توضیحات:** داوطلبان باید بتوانند یک سرور ایمیل را مدیریت کنند، شامل پیکربندی نام‌های مستعار ایمیل، quotaهای ایمیل و دامنه‌های ایمیل مجازی. این هدف شامل پیکربندی رله‌های ایمیل داخلی و مانیتورینگ سرورهای ایمیل است.

**نواحی کلیدی دانش:**

* فایل‌های پیکربندی برای postfix
* پیکربندی TLS اساسی برای postfix
* دانش اساسی از پروتکل SMTP
* آگاهی از sendmail و exim

**اصطلاحات و ابزارها:**

* فایل‌ها و دستورهای پیکربندی برای postfix
* /etc/postfix/
* /var/spool/postfix/
* دستورهای لایه شبیه‌سازی sendmail
* /etc/aliases
* logهای مرتبط با ایمیل در /var/log/

## ایمیل چیست؟

ایمیل الکترونیکی (ایمیل یا e-mail) روشی برای تبادل پیام‌ها ("mail") بین مردم با استفاده از دستگاه‌های الکترونیکی است. ایمیل اولین بار در دهه 1960 استفاده محدود وارد شد و تا اواسط دهه 1970 به شکل که اکنون به عنوان ایمیل شناخته شده است تبدیل یافت. ایمیل در سراسر شبکه‌های کامپیوتر عمل می‌کند، که امروزه عمدتاً اینترنت است. از آنجا واضح است ایمیل روش بسیار قدیمی ارتباط است و گاهی گفته می‌شود که ایمیل به قدیمی خود اینترنت است! اما امروزه هیچ کسب‌وکار موفقی نمی‌تواند بدون آن زنده بماند.

## ایمیل چگونه کار می‌کند؟

ایمیل در اطراف استفاده از صندوق‌های پستی الکترونیکی مبتنی است. وقتی یک ایمیل ارسال می‌شود، پیام از سرور به سرور مسیریابی می‌شود، تمام راه تا سرور ایمیل گیرنده.

![](.gitbook/assets/mail-postfix-transfermodel.jpg)

1. اولین کاربر صندوق پستی خود را با استفاده از یکی از بسیاری از برنامه‌های کلاینت ایمیل (مانند Thunderbolt، Evolution، SquirrelMail، ...) (که به نام MUA، Mail User Agent شناخته می‌شود) باز می‌کند و یک ایمیل ارسال می‌کند.

2. سپس عامل ارسال ایمیل (MSA) پیام‌های ایمیل الکترونیکی را از یک عامل کاربر ایمیل (MUA) دریافت می‌کند و با یک عامل انتقال ایمیل (MTA) برای تحویل ایمیل همکاری می‌کند.

3. پیام به سرور ایمیل مأموریت شده با حمل ایمیل‌ها (نامیده شده MTA، برای Mail Transport Agent) به MTA گیرنده ارسال می‌شود. در اینترنت، MTAs با استفاده از پروتکل SMTP با یکدیگر ارتباط برقرار می‌کنند و بنابراین منطقاً به عنوان سرورهای SMTP (یا گاهی سرورهای ایمیل خروجی) شناخته می‌شوند.

* **SMTP** (پروتکل انتقال ساده ایمیل). این پروتکلی است که واقعاً تعریف می‌کند که ایمیل چگونه منتقل و ذخیره می‌شود و بخشی از لایه کاربرد TCP/IP و همچنین قوانین تنظیم است که برنامه‌های ایمیل از آن پیروی می‌کنند.

4. MTA گیرنده سپس ایمیل را به سرور ایمیل ورودی (نامیده شده MDA، برای Mail Delivery Agent) تحویل می‌دهد، که ایمیل را تا زمانی که کاربر آن را بپذیرد ذخیره می‌کند. (گاهی اوقات MTA نیز می‌تواند به عنوان MDA عمل کند) اما اغلب (procmail برای مثال)، آن‌ها برنامه‌های مستقلی هستند که همچنین می‌توانند ایمیل را فیلتر کنند (مانند spam).

دو پروتکل اصلی برای بازیابی ایمیل روی یک MDA وجود دارد:

* **POP3** (پروتکل اداره پست)، که توسط MUAs برای بازیابی ایمیل و، در برخی موارد، یک کپی از آن را روی سرور باقی می‌گذارد استفاده می‌شود.
*   **IMAP** (پروتکل دسترسی پیام اینترنت)، که توسط MUAs برای هماهنگی وضعیت ایمیل‌ها (خوانده شده، حذف شده، جابه‌جا شده) در سراسر کلاینت‌های ایمیل متعدد استفاده می‌شود. با IMAP، یک کپی از هر پیام روی سرور ذخیره می‌شود، به طوری که این وظیفه همگام‌سازی می‌تواند کامل شود.
*   هر دو می‌توانند با گواهی‌نامه‌های TLS یا SSL ایمن شوند، بنابراین در برخی سطوح بین سرور و کلاینت کاربر نهایی (MUA) رمزگذاری می‌شوند.
